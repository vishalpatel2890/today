# Epic 7: Offline-First PWA

**Date:** 2026-01-07
**Tech-Spec:** [tech-spec-offline-pwa.md](../tech-spec-offline-pwa.md)
**Status:** Ready for Development

---

## Goal

Transform the Today app into a true Progressive Web App (PWA) that works seamlessly offline, allowing users to add, edit, and complete tasks without network connectivity, with automatic synchronization to Supabase when reconnected.

## Scope

**In Scope:**
- PWA manifest and service worker for app installation
- IndexedDB storage with Dexie.js for robust offline data
- Sync queue for offline operations with retry logic
- Conflict resolution (last-write-wins)
- Offline/online status indicator in UI

**Out of Scope:**
- Push notifications
- Background fetch API
- Web Share API integration
- Full CRDT-based conflict resolution

## Success Criteria

1. App installable as PWA on Chrome, Safari, and mobile browsers
2. App loads and functions when device is offline
3. Tasks created/edited offline sync automatically when online
4. User can see offline status and pending sync count
5. No data loss during offline/online transitions

## Dependencies

- Epic 5 (Email Linking) - Auth flow must work with offline patterns
- Epic 6 (Task Notes) - Notes must sync with same queue

## Story Map

| Story | Title | Focus |
|-------|-------|-------|
| 7.1 | PWA Foundation | Service worker, manifest, installable |
| 7.2 | IndexedDB + Dexie | Offline storage layer |
| 7.3 | Sync Queue | Queue operations, process when online |
| 7.4 | Offline UI | Status indicator, conflict resolution |

---

## Stories

### Story 7.1: PWA Foundation
Install vite-plugin-pwa, create manifest, configure service worker for asset caching.

### Story 7.2: IndexedDB + Dexie Setup
Create Dexie database schema, migrate from localStorage, integrate with useTasks.

### Story 7.3: Sync Queue Implementation
Build sync queue for offline operations, implement retry logic, process on reconnect.

### Story 7.4: Offline UI + Conflict Resolution
Add offline indicator to Header, implement conflict detection, add sync status badge.

---

_Epic generated by BMAD Tech-Spec Workflow_
